webpackJsonp([90],{"40I8":function(e,i,t){"use strict";function a(e){t("4S/u")}Object.defineProperty(i,"__esModule",{value:!0});var l=t("2sCs"),s=t.n(l),o=[{imageWidth:"",optValue:"",dataType:1,custom:!1,display:!0,channel:!0,label:"栏目名称",rows:"3",priority:10,defValue:"",required:!0,imageHeight:"",single:!1,help:"",field:"name",size:"",helpPosition:"",id:618,cols:"30"},{imageWidth:"",optValue:"",dataType:2,custom:!1,display:!0,channel:!0,label:"访问路径",rows:"3",priority:10,defValue:"",required:!0,imageHeight:"",single:!1,help:"",field:"path",size:"",helpPosition:"",id:619,cols:"30"},{imageWidth:"",optValue:"",dataType:1,custom:!1,display:!0,channel:!0,label:"meta标题",rows:"3",priority:10,defValue:"",required:!0,imageHeight:"",single:!1,help:"",field:"title",size:"",helpPosition:"",id:620,cols:"30"},{imageWidth:"",optValue:"",dataType:1,custom:!1,display:!0,channel:!0,label:"meta关键字",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"keywords",size:"",helpPosition:"",id:621,cols:"30"},{imageWidth:"",optValue:"",dataType:4,custom:!1,display:!0,channel:!0,label:"meta描述",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"description",size:"",helpPosition:"",id:622,cols:"30"},{imageWidth:"",optValue:[],dataType:6,custom:!1,display:!0,channel:!0,label:"栏目模板",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"tplChannel",size:"",helpPosition:"",id:623,cols:"30"},{imageWidth:"",optValue:[],dataType:6,custom:!1,display:!0,channel:!0,label:"内容模板",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"tplContent",size:"",helpPosition:"",id:624,cols:"30"},{imageWidth:"",optValue:[],dataType:6,custom:!1,display:!0,channel:!0,label:"栏目手机模板",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"tplMobileChannel",size:"",helpPosition:"",id:625,cols:"30"},{imageWidth:"",optValue:"",dataType:4,custom:!1,display:!0,channel:!0,label:"栏目静态化",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"channelStatic",size:"",helpPosition:"",id:626,cols:"30"},{imageWidth:"",optValue:"",dataType:4,custom:!1,display:!0,channel:!0,label:"内容静态化",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"contentStatic",size:"",helpPosition:"",id:627,cols:"30"},{imageWidth:"",optValue:"",dataType:2,custom:!1,display:!0,channel:!0,label:"排列顺序",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"priority",size:"",helpPosition:"",id:628,cols:"30"},{imageWidth:"",optValue:[],dataType:8,custom:!1,display:!0,channel:!0,label:"显示",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"display",size:"",helpPosition:"",id:629,cols:"30"},{imageWidth:"",optValue:[],dataType:8,custom:!1,display:!0,channel:!0,label:"文档图片",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"docImg",size:"",helpPosition:"",id:630,cols:"30"},{imageWidth:"",optValue:[],dataType:6,custom:!1,display:!0,channel:!0,label:"审核后",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"afterCheck",size:"",helpPosition:"",id:631,cols:"30"},{imageWidth:"",optValue:[],dataType:8,custom:!1,display:!0,channel:!0,label:"评论",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"commentControl",size:"",helpPosition:"",id:632,cols:"30"},{imageWidth:"",optValue:[],dataType:8,custom:!1,display:!0,channel:!0,label:"顶踩",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"allowUpdown",size:"",helpPosition:"",id:633,cols:"30"},{imageWidth:"",optValue:[],dataType:8,custom:!1,display:!0,channel:!0,label:"分享",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"allowShare",size:"",helpPosition:"",id:634,cols:"30"},{imageWidth:"",optValue:[],dataType:8,custom:!1,display:!0,channel:!0,label:"评分",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"allowScore",size:"",helpPosition:"",id:635,cols:"30"},{imageWidth:"",optValue:[],dataType:7,custom:!1,display:!0,channel:!0,label:"浏览权限",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"viewGroupIds",size:"",helpPosition:"",id:636,cols:"30"},{imageWidth:"",optValue:[],dataType:7,custom:!1,display:!0,channel:!0,label:"投稿权限",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!1,help:"",field:"contriGroupIds",size:"",helpPosition:"",id:637,cols:"30"},{imageWidth:"",optValue:"",dataType:1,custom:!1,display:!0,channel:!0,label:"外部链接",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"link",size:"",helpPosition:"",id:639,cols:"30"},{imageWidth:"",optValue:"",dataType:1,custom:!1,display:!0,channel:!0,label:"标题图",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"titleImg",size:"",helpPosition:"",id:640,cols:"30"},{imageWidth:"",optValue:"",dataType:1,custom:!1,display:!0,channel:!0,label:"内容图",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"contentImg",size:"",helpPosition:"",id:641,cols:"30"},{imageWidth:"",optValue:"",dataType:4,custom:!1,display:!0,channel:!0,label:"内容",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"txt",size:"",helpPosition:"",id:642,cols:"30"},{imageWidth:"",optValue:"",dataType:4,custom:!1,display:!0,channel:!0,label:"内容1",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"txt1",size:"",helpPosition:"",id:643,cols:"30"},{imageWidth:"",optValue:"",dataType:4,custom:!1,display:!0,channel:!0,label:"内容2",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"txt2",size:"",helpPosition:"",id:644,cols:"30"},{imageWidth:"",optValue:"",dataType:4,custom:!1,display:!0,channel:!0,label:"内容3",rows:"3",priority:10,defValue:"",required:!1,imageHeight:"",single:!0,help:"",field:"txt3",size:"",helpPosition:"",id:645,cols:"30"}],n={data:function(){return{loading:!1,modelName:"默认",items:[],params:{modelId:0,isChannel:!0,modelName:""},defaultTypeList:o,copyDefaultTypeList:[],checkDefaultTypeList:[],saveTypeList:[],disabledDefault:!0,disabled:!0,defaultParams:"name,path"}},methods:{getItems:function(){var e=this;this.loading=!0,s.a.post(this.$api.itemList,this.params).then(function(i){e.items=i.body,e.changeDefaultList(),setTimeout(function(){e.toggleSelection()},200),e.loading=!1})},saveDefaultItems:function(e){var i=this,t={modelId:this.$route.query.modelId,isChannel:this.$route.query.isChannel,fields:[],labels:[],dataTypes:[],prioritys:[],singles:[],displays:[]};for(var a in e)t.fields.push(e[a].field),t.labels.push(e[a].label),t.dataTypes.push(e[a].dataType),t.prioritys.push(e[a].priority),t.singles.push(e[a].single),t.displays.push(e[a].display);t.fields=t.fields.join(","),t.labels=t.labels.join(","),t.prioritys=t.prioritys.join(","),t.dataTypes=t.dataTypes.join(","),t.singles=t.singles.join(","),t.displays=t.displays.join(","),s.a.post(this.$api.itemListSave,t).then(function(e){200==e.code&&(i.successMessage("保存默认字段成功"),i.getItems())})},saveItems:function(e){var i=this,t={modelId:this.$route.query.modelId,isChannel:this.$route.query.isChannel,ids:[],labels:[],dataTypes:[],priorities:[],singles:[],displays:[]};for(var a in e)t.ids.push(e[a].id),t.labels.push(e[a].label),t.dataTypes.push(e[a].dataType),t.priorities.push(e[a].priority),t.singles.push(e[a].single),t.displays.push(e[a].display);t.ids=t.ids.join(","),t.labels=t.labels.join(","),t.priorities=t.priorities.join(","),t.dataTypes=t.dataTypes.join(","),t.singles=t.singles.join(","),t.displays=t.displays.join(","),s.a.post(this.$api.itemPriority,t).then(function(e){200==e.code&&(i.successMessage("保存成功"),i.getItems())})},deleteItems:function(e){var i=this,t=[];for(var a in e)this.defaultParams.indexOf(e[a].field)<0&&t.push(e[a].id);t.length>0?this.$confirm("确定要删除吗?","警告",{type:"error"}).then(function(e){s.a.post(i.$api.itemDelete,{ids:t.join(",")}).then(function(e){200==e.code&&(i.successMessage("删除成功"),i.defaultTypeList=o,setTimeout(function(){i.getItems()},500))})}).catch(function(e){}):this.errorMessage("您所选择的为系统字段,无法删除")},defaultTypeChange:function(e){this.checkDefaultTypeList=e},checkIds:function(e){this.saveTypeList=e;for(var i=[],t=0;t<e.length;t++)i.push(e[t].id);0==i.length?(this.ids="",this.disabled=!0):(this.ids=i.join(","),this.disabled=!1)},checkboxInit:function(e,i){return this.defaultParams.indexOf(e.field)>=0?0:1},toggleSelection:function(){var e=this,i=this.defaultParams,t=this.copyDefaultTypeList,a=[];for(var l in t)i.indexOf(t[l].field)>=0&&a.push(t[l]);a.forEach(function(i){e.$refs.multipleTable.toggleRowSelection(i,!0)})},changeDefaultList:function(){this.copyDefaultTypeList=[];for(var e in this.defaultTypeList){var i=0;for(var t in this.items)this.items[t].field==this.defaultTypeList[e].field&&i++;0==i&&this.copyDefaultTypeList.push(this.defaultTypeList[e])}}},created:function(){var e=this.$route.query.modelId,i=this.$route.query.isChannel;this.modelName=this.$route.query.modelName,this.params.modelId=e,this.params.isChannel=i,this.params.modelName=this.modelName,this.getItems()},mounted:function(){}},d=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"cms-body"},[t("cms-back"),e._v(" "),t("div",{staticClass:"table-top-bar clearfix"},[t("div",{staticClass:"query-inline-box"},[t("div",{staticClass:"bread-box"},[t("label",{staticStyle:{"font-size":"14px"}},[e._v("当前栏目模型：")]),e._v(" "),t("ul",{staticClass:"type-bread"},[t("li",{staticClass:"bread-items"},[t("a",{attrs:{href:"javascript:void(0)"}},[e._v(e._s(e.modelName)+" \n                         "),t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/channelModel/add",expression:"'/channelModel/add'"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(i){e.routerLink("/channelModel/save","save",0,e.params)}}},[e._v("添加")]),e._v(" "),t("span",{staticClass:"red"},[e._v("(标红字段为必选字段,无法删除，未勾选独占一行的字段不间断的个数必须是2的倍数，否则后台栏目页会乱)")])],1)])])])])]),e._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.items,stripe:""},on:{"selection-change":e.checkIds}},[t("el-table-column",{attrs:{type:"selection",align:"center",width:68}}),e._v(" "),t("el-table-column",{attrs:{label:"字段",prop:"field",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"word",class:[e.defaultParams.indexOf(i.row.field)>=0?"red":""]},[e._v(e._s(i.row.field))])]}}])}),e._v(" "),e.items.length>0?t("el-table-column",{attrs:{label:"数据类型",prop:"dataType",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[1==i.row.dataType?t("span",[e._v("字符串文本")]):e._e(),e._v(" "),2==i.row.dataType?t("span",[e._v("整形文本")]):e._e(),e._v(" "),3==i.row.dataType?t("span",[e._v("浮点形文本")]):e._e(),e._v(" "),4==i.row.dataType?t("span",[e._v("文本区")]):e._e(),e._v(" "),5==i.row.dataType?t("span",[e._v("日期")]):e._e(),e._v(" "),6==i.row.dataType?t("span",[e._v("下拉列表")]):e._e(),e._v(" "),7==i.row.dataType?t("span",[e._v("复选框")]):e._e(),e._v(" "),8==i.row.dataType?t("span",[e._v("单选框")]):e._e(),e._v(" "),9==i.row.dataType?t("span",[e._v("附件")]):e._e(),e._v(" "),10==i.row.dataType?t("span",[e._v("图片")]):e._e()]}}])}):e._e(),e._v(" "),t("el-table-column",{attrs:{label:"名称",prop:"label",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-input",{staticStyle:{width:"150px"},model:{value:i.row.label,callback:function(t){e.$set(i.row,"label",t)},expression:"scope.row.label"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"排序",prop:"priority",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-input",{staticClass:"w50",attrs:{type:"number",min:"0"},model:{value:i.row.priority,callback:function(t){e.$set(i.row,"priority",t)},expression:"scope.row.priority"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"独占一行",prop:"single",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-checkbox",{model:{value:i.row.single,callback:function(t){e.$set(i.row,"single",t)},expression:"scope.row.single"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"显示",prop:"display",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-checkbox",{model:{value:i.row.display,callback:function(t){e.$set(i.row,"display",t)},expression:"scope.row.display"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.defaultParams.indexOf(i.row.field)>=0?e._e():t("cms-button",{directives:[{name:"perms",rawName:"v-perms",value:"/channelModel/update",expression:"'/channelModel/update'"}],attrs:{type:"edit"},nativeOn:{click:function(t){e.routerLink("/channelModel/update","update",i.row.id,e.params)}}}),e._v(" "),e.defaultParams.indexOf(i.row.field)>=0?e._e():t("cms-button",{directives:[{name:"perms",rawName:"v-perms",value:"/channelModel/delete",expression:"'/channelModel/delete'"}],attrs:{type:"delete"},nativeOn:{click:function(t){e.deleteItems([i.row])}}})]}}])})],1),e._v(" "),e.copyDefaultTypeList.length>0?t("div",{staticClass:"default-size"},[e._v("系统默认字段"),t("span",{staticClass:"red"},[e._v("(标红字段为必选字段)")])]):e._e(),e._v(" "),e.copyDefaultTypeList.length>0?t("el-table",{ref:"multipleTable",attrs:{data:e.copyDefaultTypeList,stripe:""},on:{"selection-change":e.defaultTypeChange}},[t("el-table-column",{attrs:{type:"selection",align:"center",width:68,selectable:e.checkboxInit}}),e._v(" "),t("el-table-column",{attrs:{label:"字段",prop:"field",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"word",class:[e.defaultParams.indexOf(i.row.field)>=0?"red":""]},[e._v(e._s(i.row.field))])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"数据类型",prop:"dataType",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[1==i.row.dataType?t("span",[e._v("字符串文本")]):e._e(),e._v(" "),2==i.row.dataType?t("span",[e._v("整形文本")]):e._e(),e._v(" "),3==i.row.dataType?t("span",[e._v("浮点形文本")]):e._e(),e._v(" "),4==i.row.dataType?t("span",[e._v("文本区")]):e._e(),e._v(" "),5==i.row.dataType?t("span",[e._v("日期")]):e._e(),e._v(" "),6==i.row.dataType?t("span",[e._v("下拉列表")]):e._e(),e._v(" "),7==i.row.dataType?t("span",[e._v("复选框")]):e._e(),e._v(" "),8==i.row.dataType?t("span",[e._v("单选框")]):e._e(),e._v(" "),9==i.row.dataType?t("span",[e._v("附件")]):e._e(),e._v(" "),10==i.row.dataType?t("span",[e._v("图片")]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"名称",prop:"label",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"排序",prop:"priority",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"独占一行",prop:"single",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-checkbox",{attrs:{disabled:""},model:{value:i.row.single,callback:function(t){e.$set(i.row,"single",t)},expression:"scope.row.single"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"显示",prop:"display",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-checkbox",{attrs:{disabled:""},model:{value:i.row.display,callback:function(t){e.$set(i.row,"display",t)},expression:"scope.row.display"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"}})],1):e._e(),e._v(" "),t("div",{staticClass:"cms-list-footer"},[t("div",{staticClass:"pull-left"},[e.copyDefaultTypeList.length>0?t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/channelModel/save",expression:"'/channelModel/save'"}],attrs:{disabled:e.checkDefaultTypeList.length<=0},on:{click:function(i){e.saveDefaultItems(e.checkDefaultTypeList)}}},[e._v("保存默认选中字段")]):e._e(),e._v(" "),t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/channelModel/savePriority",expression:"'/channelModel/savePriority'"}],attrs:{disabled:e.disabled},on:{click:function(i){e.saveItems(e.saveTypeList)}}},[e._v("保存内容")]),e._v(" "),t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/channelModel/delete",expression:"'/channelModel/delete'"}],attrs:{disabled:e.disabled},on:{click:function(i){e.deleteItems(e.saveTypeList)}}},[e._v("删除")])],1)])],1)},r=[],p={render:d,staticRenderFns:r},c=p,u=t("8AGX"),h=a,m=u(n,c,!1,h,"data-v-564bb256",null);i.default=m.exports},"4S/u":function(e,i,t){var a=t("ApRv");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t("8bSs")("32cf7b6e",a,!0)},ApRv:function(e,i,t){i=e.exports=t("l95E")(!1),i.push([e.i,"\n.default-size[data-v-564bb256] {\n  padding: 12px 24px;\n  font-size: 14px;\n}\n.red[data-v-564bb256] {\n  color: red;\n}\n.word[data-v-564bb256] {\n  text-transform: lowercase;\n}\n",""])}});